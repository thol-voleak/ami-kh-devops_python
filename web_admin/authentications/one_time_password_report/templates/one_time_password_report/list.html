{% extends "base.html" %}
{% load static %}
{% load permissions_filter %}

{% block content %}

<div class="col-md-12">
    <div class="panel mb25">
        <div class="panel-heading border mb15">
            <h3>One Time Password Report</h3>
        </div>
    </div>
      <div class="panel-body">
        <form id="submit-form" class="form-horizontal" role="form" method="post" action="">
            {% csrf_token %}
            <div class="form-group">
                <label class="col-sm-2 control-label">ID</label>
                <div class="col-sm-2">
                    <input type="number" class="form-control input-rounded" name="otp_id" id="txt_otp_id" value="{{ otp_id }}">
                </div>
                <label class="col-sm-2 control-label">User ID</label>
                <div class="col-sm-2">
                    <input type="number" class="form-control input-rounded" name="user_id" id="txt_user_id" value="{{ user_id }}">
                </div>
                <label class="col-sm-2 control-label">User Reference Code</label>
                <div class="col-sm-2">
                    <input type="text" class="form-control input-rounded" name="user_ref_code" id="txt_user_ref_code" value="{{ user_ref_code }}">
                </div>
            </div>
            <div class="form-group">
                 <label class="col-sm-2 control-label">Delivery Channel</label>
                <div class="col-sm-2">
                    <select class="form-control" id="ddl_delivery_channel" name="delivery_channel">
                            <option value='All' {% if delivery_channel == 'All' %}selected="selected"{%endif%}>All</option>
                            <option value='' {% if delivery_channel == '' %}selected="selected"{%endif%}>-</option>
                            <option value='SMS' {%if delivery_channel == 'SMS' %}selected="selected"{%endif%}>SMS</option>
                            <option value='EMAIL' {%if delivery_channel == 'EMAIL' %}selected="selected"{%endif%}>EMAIL</option>
                            <option value='PUSH NOTIFICATION' {%if delivery_channel == 'PUSH NOTIFICATION' %}selected="selected"{%endif%}>PUSH NOTIFICATION</option>
                    </select>
                </div>
                <label class="col-sm-2 control-label">Email</label>
                <div class="col-sm-2">
                    <input type="text" class="form-control input-rounded" name="email" id="txt_email" value="{{ email }}">
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-1 col-sm-offset-11">
                    <input id="current_page_index" name="current_page_index" style="display:none" value="1">
                    <input id="btn_search" class="btn btn-success btn-block" type="submit" name="search" value="Search">
                </div>
            </div>
            <label class="pull-right" id="lbl_total">{{ search_count }}</label>
            <label class="pull-right">Total records found:&nbsp;</label>
        </form>
        <div class="table-responsive">
            <table class="table table-bordered table-striped mb0" id="tbl_otp_list">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>System OTP Reference ID</th>
                    <th>User Reference Code</th>
                    <th>User Type</th>
                    <th>User ID</th>
                    <th>Delivery Channel</th>
                    <th>Email</th>
                    <th>Mobile Number</th>
                    <th>Is Passed Validation</th>
                    <th>Fail Validation Count</th>
                    <th>Is_Deleted</th>
                    <th>Created Date(UTC+0)</th>
                    <th>Updated Date(UTC+0)</th>
                    <th>Expired Date(UTC+0)</th>
                </tr>
                </thead>
                <tbody id="table_body">
                {% for otp in otp_list %}
                    <tr>
                        <td>{{ otp.id }}</td>
                        <td>{{ otp.otp_reference_id|default_if_none:""}}</td>
                        <td>{{ otp.user_reference_code|default_if_none:""}}</td>
                        <td>{{ otp.user_type|default_if_none:"" }}</td>
                        <td>{{ otp.user_id|default_if_none:"" }}</td>
                        <td>{{ otp.delivery_channel|default_if_none:"" }}</td>
                        <td>{{ otp.email|default_if_none:"" }}</td>
                        <td>{{ otp.mobile_number|default_if_none:"" }}</td>
                        <td>{{ otp.is_passed_validation|yesno:"Yes,No,''"  }}</td>
                        <td>{{ otp.failed_validation_count|default_if_none:"" }}</td>
                        <td>{{ otp.is_deleted|yesno:"Yes,No,''" }}</td>
                        <td>{{ otp.created_timestamp|default_if_none:"" }}</td>
                        <td>{{ otp.last_updated_timestamp|default_if_none:"" }}</td>
                        <td>{{ otp.expired_timestamp|default_if_none:"" }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        {% include "pagination.html" %}
    </div>
</div>
{% endblock %}