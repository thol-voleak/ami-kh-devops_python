{% extends "base.html" %}

{% block content %}
<div class="panel mb25">
    <div class="panel-heading border">
        <h3>Add Service Tier</h3>
    </div>
    {% for message in messages %}
    <div class="col-xs-12">
        <div class='alert
                    {%if "successfully" in message%}
                    alert-success
                    {% else %}
                    alert-danger
                    {% endif %}
                    alert-dismissable' id="msg-add-tier">
            <a href="#" class="close" data-dismiss="alert" aria-label="close">Ã—</a>
            <strong>{{ message|capfirst }}</strong>
        </div>
    </div>
    {% endfor %}
    <div class="panel-body">
        <div class="row no-margin">
            <div class="col-lg-12">
                <form class="form-horizontal" role="form" method="post"
                      action="">
                    {% csrf_token %}

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Clone from Tier:</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_clone_from" name="clone_from"
                                    onchange="setClone(this)">
                                <option value=""></option>
                                {% for fee_tier in fee_tiers %}
                                    {% if fee_tier.fee_tier_id|slugify == body.clone_from|slugify %}
                                        <option value="{{ fee_tier.fee_tier_id }}" selected>{{ fee_tier.fee_tier_id }}</option>
                                    {% else %}
                                        <option value="{{ fee_tier.fee_tier_id }}">{{ fee_tier.fee_tier_id }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Service Name</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="service_name" id="txt_service_name"
                                   value="{{ service_name }}" required readonly/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Command</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="command" id="txt_command"
                                   value="{{ command_name }}" required readonly/>
                        </div>
                    </div>

                    <input type="hidden" class="form-control" name="settlement_type" id="ddl_settlement_type"
                           value="Amount" required readonly/>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Condition</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_condition" name="condition" required>
                                {% for item in conditions %}
                                    {% if item.fee_tier_condition == body.fee_tier_condition %}
                                     <option value="{{ item.fee_tier_condition }}" selected>{{item.fee_tier_condition}}</option>
                                    {% else %}
                                     <option value="{{ item.fee_tier_condition }}">{{item.fee_tier_condition}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_amount">Amount *</label>
                        <div class="col-sm-8">
                            <input value="{{ body.condition_amount|default_if_none:'' }}" type="text" step="0.01" class="form-control" name="condition_amount" id="txt_amount"  onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Fee Type</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_fee_type" name="fee_type">
                                <option value="">-</option>
                                {% for item in fee_types %}
                                    {% if item.fee_type == body.fee_type %}
                                     <option value="{{ item.fee_type }}" selected>{{ item.fee_type }}</option>
                                    {% else %}
                                     <option value="{{ item.fee_type|default_if_none:'0' }}">{{ item.fee_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_fee_amount">Fee Amount *</label>
                        <div class="col-sm-8">
                            <input value="{{ body.fee_amount }}" type="text" class="form-control"
                                   name="fee_amount" id="txt_fee_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required />
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Bonus Type</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_bonus_type" name="bonus_type">
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.bonus_type %}
                                     <option value="{{ item.bonus_type }}" selected>{{ item.bonus_type }}</option>
                                    {% else %}
                                     <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="from">
                        <label class="col-sm-2 control-label" id="txt_from">From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_from" name="amount_type">
                                {% for type in amount_types %}
                                    {% if type.amount_type == body.amount_type %}
                                     <option value="{{ type.amount_type }}" selected>{{ type.amount_type }}</option>
                                    {% else %}
                                     <option value="{{ type.amount_type }}">{{ type.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_bonus_amount">Bonus Amount *</label>
                        <div class="col-sm-8">
                            <input value="{{ body.bonus_amount|default_if_none:'' }}" type="text" class="form-control" name="bonus_amount" id="txt_bonus_amount" onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ a_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_a" name="a" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.a %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="a_from" >
                        <label class="col-sm-2 control-label" id="txt_a_from">{{ a_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_a_from" name="a_from" value="Amount">
                                {% for item in tier_amount_froms %}
                                    {% if body.a_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.a_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_a_amount">{{ a_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.a_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_a_amount');" name="a_amount" id="txt_a_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ b_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_b" name="b" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.b %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="b_from" >
                        <label class="col-sm-2 control-label" id="txt_b_from">{{ b_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_b_from" name="b_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.b_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.b_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_b_amount">{{ b_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.b_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_b_amount');" name="b_amount" id="txt_b_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ c_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_c" name="c" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.c %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="c_from" >
                        <label class="col-sm-2 control-label" id="txt_c_from">{{ c_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_c_from" name="c_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.c_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.c_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_c_amount">{{ c_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.c_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_c_amount');" name="c_amount" id="txt_c_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ d_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_d" name="d" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.d %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="d_from" >
                        <label class="col-sm-2 control-label" id="txt_d_from">{{ d_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_d_from" name="d_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.d_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.d_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_d_amount">{{ d_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.d_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_d_amount');" name="d_amount" id="txt_d_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ e_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_e" name="e" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.e %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="e_from" >
                        <label class="col-sm-2 control-label" id="txt_e_from">{{ e_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_e_from" name="e_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.e_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.e_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_e_amount">{{ e_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.e_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_e_amount');" name="e_amount" id="txt_e_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ f_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_f" name="f" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.f %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="f_from" >
                        <label class="col-sm-2 control-label" id="txt_f_from">{{ f_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_f_from" name="f_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.f_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.f_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_f_amount">{{ f_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.f_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_f_amount');" name="f_amount" id="txt_f_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ g_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_g" name="g" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.g %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="g_from" >
                        <label class="col-sm-2 control-label" id="txt_g_from">{{ g_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_g_from" name="g_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.g_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.g_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_g_amount">{{ g_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.g_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_g_amount');" name="g_amount" id="txt_g_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ h_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_h" name="h" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.h %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="h_from" >
                        <label class="col-sm-2 control-label" id="txt_h_from">{{ h_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_h_from" name="h_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.h_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.h_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_h_amount">{{ h_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.h_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_h_amount');" name="h_amount" id="txt_h_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ i_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_i" name="i" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.i %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="i_from" >
                        <label class="col-sm-2 control-label" id="txt_i_from">{{ i_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_i_from" name="i_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.i_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.i_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_i_amount">{{ i_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.i_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_i_amount');" name="i_amount" id="txt_i_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ j_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_j" name="j" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.j %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="j_from" >
                        <label class="col-sm-2 control-label" id="txt_j_from">{{ j_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_j_from" name="j_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.j_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.j_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_j_amount">{{ j_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.j_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_j_amount');" name="j_amount" id="txt_j_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ k_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_k" name="k" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.k %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="k_from" >
                        <label class="col-sm-2 control-label" id="txt_k_from">{{ k_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_k_from" name="k_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.k_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.k_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_k_amount">{{ k_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.k_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_k_amount');" name="k_amount" id="txt_k_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ l_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_l" name="l" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.l %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="l_from" >
                        <label class="col-sm-2 control-label" id="txt_l_from">{{ l_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_l_from" name="l_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.l_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.l_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_l_amount">{{ l_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.l_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_l_amount');" name="l_amount" id="txt_l_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ m_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_m" name="m" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.m %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="m_from" >
                        <label class="col-sm-2 control-label" id="txt_m_from">{{ m_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_m_from" name="m_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.m_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.m_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_m_amount">{{ m_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.m_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_m_amount');" name="m_amount" id="txt_m_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ n_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_n" name="n" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.n %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="n_from" >
                        <label class="col-sm-2 control-label" id="txt_n_from">{{ n_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_n_from" name="n_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.n_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.n_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_n_amount">{{ n_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.n_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_n_amount');" name="n_amount" id="txt_n_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ o_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_o" name="o" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == body.o %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="o_from" >
                        <label class="col-sm-2 control-label" id="txt_o_from">{{ o_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_o_from" name="o_from">
                                {% for item in tier_amount_froms %}
                                    {% if body.o_from == None %}
                                        {% if  item.amount_type == 'Amount' %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% else %}
                                        {% if item.amount_type == body.o_from %}
                                            <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                        {% else %}
                                            <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_o_amount">{{ o_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ body.o_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_o_amount');" name="o_amount" id="txt_o_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="pull-right">
                        <a href="{% url 'services:fee_tier_list' service_id command_id service_command_id %}">
                            <input id="btn_cancel" class="btn text-left mb15" type="button"
                                   value="Cancel"/>
                        </a>
                        <input id="btn_add" class="btn btn-success text-left mb15" type="submit"
                                   value="Add" onClick="validateAmountFields(e)"/>

                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block body_js %}
{{ block.super }}
<script>
function changeStep(c){

  var new_decimal = {{ decimal }} * -1;
  c.step = Math.pow(10, new_decimal);
}

function forceAmountNumber(any_amount) {
    var deci = {{ decimal }};
    var amount = document.getElementById(any_amount);
    any_amt = $('#' + any_amount);
    any_amt.keypress(function (event) {
        var $this = $(this);
        if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
            ((event.which < 48 || event.which > 57) &&
                (event.which != 0 && event.which != 8))) {
            event.preventDefault();
        }

        var text = $(this).val();
        if ((event.which == 46) && (text.indexOf('.') == -1)) {
            setTimeout(function () {
                if ($this.val().substring($this.val().indexOf('.')).length > deci + 1) {
                    $this.val($this.val().substring(0, $this.val().indexOf('.') + deci + 1));
                }
            }, 1);
        }
        if ((text.indexOf('.') != -1) &&
            (text.substring(text.indexOf('.')).length > deci) &&
            (event.which != 0 && event.which != 8) &&
            ($(this)[0].selectionStart >= text.length - deci)) {
            event.preventDefault();
        }
    });

    any_amt.bind("paste", function (e) {
        var text = e.originalEvent.clipboardData.getData('Text');
        if ($.isNumeric(text)) {
            if ((text.substring(text.indexOf('.')).length > deci + 1 ) && (text.indexOf('.') > -1)) {
                e.preventDefault();
                $(this).val(text.substring(0, text.indexOf('.') + deci + 1));
            }
        }
        else {
            e.preventDefault();
        }
    });

    amount.onblur = function () {
        num = amount.value;
        if (num != "") {
            num = parseFloat(num);
            num = num.toFixed(deci);
            amount.value = num;
        }
    }
}

function forceNumber(any_amount, any_type) {
    var deci = 0;
    var ddl = document.getElementById(any_type);
    var amount = document.getElementById(any_amount);
    ddl.onchange = function () {
        amount.value = '';
    }
    any_amt = $('#' + any_amount);
    var e = document.getElementById(any_type);
    if (e.value == '% rate') {
        deci = {{ payment_decimal }};
    }
    else if (e.value == 'Flat value') {
        deci = {{ decimal }};
    }
    else {
        deci = 0;
    }

    $('#' + any_type).change(function () {
        var e = document.getElementById(any_type);
        if (e.value == '% rate') {
            deci = {{ payment_decimal }};
        }
        else if (e.value == 'Flat value') {
            deci = {{ decimal }};
        }
        else {
            deci = 0;
        }
    });

    any_amt.keypress(function (event) {
        var $this = $(this);
        if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
            ((event.which < 48 || event.which > 57) &&
                (event.which != 0 && event.which != 8))) {
            event.preventDefault();
        }

        var text = $(this).val();
        if ((event.which == 46) && (text.indexOf('.') == -1)) {
            setTimeout(function () {
                if ($this.val().substring($this.val().indexOf('.')).length > deci + 1) {
                    $this.val($this.val().substring(0, $this.val().indexOf('.') + deci + 1));
                }
            }, 1);
        }
        if ((text.indexOf('.') != -1) &&
            (text.substring(text.indexOf('.')).length > deci) &&
            (event.which != 0 && event.which != 8) &&
            !window.getSelection().toString()) {
            event.preventDefault();
        }

        if (e.value == '% rate') {
            var currentChar = parseInt(String.fromCharCode(event.keyCode), 10);
            if (!isNaN(currentChar)) {
                var nextValue = text.substring(0, amount.selectionStart) + currentChar + text.substring(amount.selectionEnd);
                if ((parseFloat(nextValue, 10) > 100) && window.getSelection().toString() !== text) event.preventDefault();
            }
        }
    });

    any_amt.bind("paste", function (e) {
        var text = e.originalEvent.clipboardData.getData('Text');
        if ($.isNumeric(text)) {
            if ((text.substring(text.indexOf('.')).length > deci + 1 ) && (text.indexOf('.') > -1)) {
                e.preventDefault();
                $(this).val(text.substring(0, text.indexOf('.') + deci + 1));
            }
        }
        else {
            e.preventDefault();
        }
    });

    amount.onblur = function () {
        num = amount.value;
        if (num != "") {
            num = parseFloat(num);
            num = num.toFixed(deci);
            amount.value = num;
        }
    }
}

forceAmountNumber("txt_amount");
forceNumber("txt_fee_amount", "ddl_fee_type");
forceNumber("txt_bonus_amount","ddl_bonus_type");
forceNumber("txt_a_amount","ddl_a");
forceNumber("txt_b_amount","ddl_b");
forceNumber("txt_c_amount","ddl_c");
forceNumber("txt_d_amount","ddl_d");
forceNumber("txt_e_amount","ddl_e");
forceNumber("txt_f_amount","ddl_f");
forceNumber("txt_g_amount","ddl_g");
forceNumber("txt_h_amount","ddl_h");
forceNumber("txt_i_amount","ddl_i");
forceNumber("txt_j_amount","ddl_j");
forceNumber("txt_k_amount","ddl_k");
forceNumber("txt_l_amount","ddl_l");
forceNumber("txt_m_amount","ddl_m");
forceNumber("txt_n_amount","ddl_n");
forceNumber("txt_o_amount","ddl_o");


// start tier level constraint
var contrainTierLevelParam = [
    ['a', '{{ a_label }}', '{{ body.a_from }}'],
    ['b', '{{ b_label }}', '{{ body.b_from }}'],
    ['c', '{{ c_label }}', '{{ body.c_from }}'],
    ['d', '{{ d_label }}', '{{ body.d_from }}'],
    ['e', '{{ e_label }}', '{{ body.e_from }}'],
    ['f', '{{ f_label }}', '{{ body.f_from }}'],
    ['g', '{{ g_label }}', '{{ body.g_from }}'],
    ['h', '{{ h_label }}', '{{ body.h_from }}'],
    ['i', '{{ i_label }}', '{{ body.i_from }}'],
    ['j', '{{ j_label }}', '{{ body.j_from }}'],
    ['k', '{{ k_label }}', '{{ body.k_from }}'],
    ['l', '{{ l_label }}', '{{ body.l_from }}'],
    ['m', '{{ m_label }}', '{{ body.m_from }}'],
    ['n', '{{ n_label }}', '{{ body.n_from }}'],
    ['o', '{{ o_label }}', '{{ body.o_from }}'],
]
$.each(contrainTierLevelParam, function(i){
    contrainTierLevel(contrainTierLevelParam[i][0], contrainTierLevelParam[i][1], contrainTierLevelParam[i][2]);
})

function contrainTierLevel(tier_level, label, tier_from) {
    var  $a = $('#ddl_'+tier_level);

    if( $a.val() == ''){
        $('#txt_'+tier_level+'_amount').attr('disabled', true);
        $("#label_"+tier_level+"_amount").text(label + " Amount");
        $("#"+tier_level+"_from").hide();
    }
    if( $a.val() == 'Flat value') {
        $("#"+tier_level+"_from").hide();
    }
    $a.change(function(){
        if( $a.val() == ''){
            $('#txt_'+tier_level+'_amount').attr('disabled', true);
            $("#label_"+tier_level+"_amount").text(label + " Amount");
            $('#txt_'+tier_level+'_amount').val('');
            $("#"+tier_level+"_from").fadeOut(500);
        }
        else if( $a.val() == 'Flat value'){
            $('#txt_'+tier_level+'_amount').removeAttr('disabled');
            if($('#txt_'+tier_level+'_amount').val() == '') {
                $('#txt_'+tier_level+'_amount').val('0');
            }
            $("#label_"+tier_level+"_amount").text(label + " Amount *");
            $("#"+tier_level+"_from").fadeOut(500);
        }
        else if( $a.val() == '% rate'){
            $('#txt_'+tier_level+'_amount').removeAttr('disabled');
            if($('#txt_'+tier_level+'_amount').val() == '') {
                $('#txt_'+tier_level+'_amount').val('0');
            }
            $("#label_"+tier_level+"_amount").text(label + " Amount *");
            $("#"+tier_level+"_from").fadeIn(1000);
        }
    })
}
// end tier level constraint


// start Amount constraint
var $condition = $('#ddl_condition');

function updateByConditionType() {
    var $condition_amount = $('#txt_amount');
    if ($condition.val() == 'unlimit') {
        $("#label_amount").text("Amount");
        $condition_amount.removeAttr('required');
        $condition_amount.attr('disabled', true);
        $condition_amount.val('');
    } else {
        $("#label_amount").text("Amount *");
        $condition_amount.attr('required', true);
        $condition_amount.removeAttr('disabled');
    }
}

updateByConditionType();
$condition.change(function () {
    updateByConditionType();
});
// end amount constraint


// start Fee Amount constraint
var $ddl_fee_type = $('#ddl_fee_type');

function validate_fee_type() {
    if ($ddl_fee_type.val() == '') {
        $('#txt_fee_amount').attr('disabled', true);
        $('#txt_fee_amount').val('');
        $("#label_fee_amount").text("Fee Amount");
    } else {
        $("#label_fee_amount").text("Fee Amount *")
        $('#txt_fee_amount').removeAttr('disabled');
        if ($('#txt_fee_amount').val() == '') {
            $('#txt_fee_amount').val('0');
        }
    }
}

$ddl_fee_type.change(function () {
    validate_fee_type();
    var element = document.getElementById('txt_fee_amount');
    element.setCustomValidity("");
});
validate_fee_type();
// end Fee Amount constraint



// start Bonus Amount constraint
var $bonus_type = $('#ddl_bonus_type');
if ($bonus_type.val() == '') {
    $('#txt_bonus_amount').attr('disabled', true);
    $("#label_bonus_amount").text("Bonus Amount");
    $("#from").hide();
}
if ($bonus_type.val() == 'Flat value') {
    $("#from").hide();
}
$bonus_type.change(function () {
    if ($bonus_type.val() == '') {
        $('#txt_bonus_amount').attr('disabled', true);
        $('#txt_bonus_amount').val('');
        $("#label_bonus_amount").text("Bonus Amount");
        $("#from").fadeOut(500);
    }
    else if ($bonus_type.val() == 'Flat value') {
        $('#txt_bonus_amount').removeAttr('disabled');
        if ($('#txt_bonus_amount').val() == '') {
            $('#txt_bonus_amount').val('0');
        }
        $("#label_bonus_amount").text("Bonus Amount *");
        $("#from").fadeOut(500);
    }
    else if ($bonus_type.val() == '% rate') {
        $('#txt_bonus_amount').removeAttr('disabled');
        if ($('#txt_bonus_amount').val() == '') {
            $('#txt_bonus_amount').val('0');
        }
        $("#label_bonus_amount").text("Bonus Amount *");
        $("#from").fadeIn(1000);
    }
})
// end Bonus Amount constraint


var txt_bonus_amount = document.getElementById("txt_bonus_amount");
var txt_fee_amount = document.getElementById('txt_fee_amount');
var condition_amount = document.getElementById('txt_amount');

function validateBonusValue() {
    /*if(txt_bonus_amount.value == '') {
        <!--txt_bonus_amount.value = '0';-->
    } else {
        // txt_bonus_amount.value = txt_bonus_amount.value.replace(/^0+/, '')
    }

    if(txt_bonus_amount.value == '') {
        <!--txt_bonus_amount.value = '0';-->
    }*/

    // Validate min value
    validateMinValue(txt_bonus_amount);
}

function validateFeeValue() {
    /*if(txt_fee_amount.value == '') {
        <!--txt_fee_amount.value = '0';-->
    } else {
        // txt_fee_amount.value = txt_fee_amount.value.replace(/^0+/, '')
    }

    if(txt_fee_amount.value == '') {
        <!--txt_fee_amount.value = '0';-->
    }*/

    // Validate min value
    validateMinValue(txt_fee_amount);

    var $ddl_fee_type = $('#ddl_fee_type');
    if ($ddl_fee_type.val() == '% rate') {
        validateMaxValue(txt_fee_amount);
    }
}

function validateConditionAmount() {
    validateMinValue(condition_amount);
}

function validateMinValue(element) {
    var value = parseFloat(element.value) || 0.0;
    if (value < 0) {
        element.setCustomValidity('Amount cannot be lower than 0');
    } else {
        element.setCustomValidity("");
        //element.value = value;
    }
}

function validateMaxValue(element) {
    var max = parseInt(element.getAttribute("max")) || 100;
    var value = parseFloat(element.value) || 0.0;
    if (value > max) {
        element.setCustomValidity('Amount cannot be greater than ' + max);
    } else {
        element.setCustomValidity("");
        //element.value = value;
    }
}

function validateAmountFields(e) {
    e.preventDefault();
    validateConditionAmount();
    validateFeeValue();
    validateBonusValue();
}

txt_bonus_amount.onkeyup = validateBonusValue;
txt_fee_amount.onkeyup = validateFeeValue;
condition_amount.onkeyup = validateConditionAmount;

var csrf_token = "{{ csrf_token }}";

function setClone(e) {
    var clone_fee_tier = e.value;
    if (clone_fee_tier !== '') {
        {# url of update_service #}
        url = "{% url 'services:fee_tier_list' service_id command_id service_command_id %}" + clone_fee_tier + "/delete/";
        $.ajax({
            url: url,
            type: "PUT",
            data: {},
            dataType: "json",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("X-CSRFToken", csrf_token);
            },
            success: function (response) {
                if (!response.fee_tier.fee_tier_id) {
                    location.reload();
                }
                if (response.fee_tier) {
                    $('#txt_service_name').val('{{ service_name }}');
                    $('#txt_command').val('{{ command_name }}');
                    $('#ddl_condition').val(response.fee_tier.fee_tier_condition).trigger('change');
                    $('#txt_amount').val(response.fee_tier.condition_amount);
                    if (response.fee_tier.fee_type == 'NON') {
                        response.fee_tier.fee_type = '';
                    }
                    $('#ddl_fee_type').val(response.fee_tier.fee_type).trigger('change');
                    $('#txt_fee_amount').val(response.fee_tier.fee_amount);
                    if (response.fee_tier.bonus_type == 'NON') {
                        response.fee_tier.bonus_type = '';
                    }
                    $('#ddl_bonus_type').val(response.fee_tier.bonus_type).trigger('change');
                    $('#ddl_from').val(response.fee_tier.amount_type);
                    $('#txt_bonus_amount').val(response.fee_tier.bonus_amount);
                    if (response.fee_tier.a == 'NON') {
                        response.fee_tier.a = '';
                    }
                    $('#ddl_a').val(response.fee_tier.a).trigger('change');
                    $('#ddl_a_from').val(response.fee_tier.a_from);
                    $('#txt_a_amount').val(response.fee_tier.a_amount);
                    if (response.fee_tier.b == 'NON') {
                        response.fee_tier.b = '';
                    }
                    $('#ddl_b').val(response.fee_tier.b).trigger('change');
                    $('#ddl_b_from').val(response.fee_tier.b_from);
                    $('#txt_b_amount').val(response.fee_tier.b_amount);
                    if (response.fee_tier.c == 'NON') {
                        response.fee_tier.c = '';
                    }
                    $('#ddl_c').val(response.fee_tier.c).trigger('change');
                    $('#ddl_c_from').val(response.fee_tier.c_from);
                    $('#txt_c_amount').val(response.fee_tier.c_amount);
                    if (response.fee_tier.d == 'NON') {
                        response.fee_tier.d = '';
                    }
                    $('#ddl_d').val(response.fee_tier.d).trigger('change');
                    $('#ddl_d_from').val(response.fee_tier.d_from);
                    $('#txt_d_amount').val(response.fee_tier.d_amount);
                    if (response.fee_tier.e == 'NON') {
                        response.fee_tier.e = '';
                    }
                    $('#ddl_e').val(response.fee_tier.e).trigger('change');
                    $('#ddl_e_from').val(response.fee_tier.e_from);
                    $('#txt_e_amount').val(response.fee_tier.e_amount);
                    if (response.fee_tier.f == 'NON') {
                        response.fee_tier.f = '';
                    }
                    $('#ddl_f').val(response.fee_tier.f).trigger('change');
                    $('#ddl_f_from').val(response.fee_tier.f_from);
                    $('#txt_f_amount').val(response.fee_tier.f_amount);
                    if (response.fee_tier.g == 'NON') {
                        response.fee_tier.g = '';
                    }
                    $('#ddl_g').val(response.fee_tier.g).trigger('change');
                    $('#ddl_g_from').val(response.fee_tier.g_from);
                    $('#txt_g_amount').val(response.fee_tier.g_amount);
                    if (response.fee_tier.h == 'NON') {
                        response.fee_tier.h = '';
                    }
                    $('#ddl_h').val(response.fee_tier.h).trigger('change');
                    $('#ddl_h_from').val(response.fee_tier.h_from);
                    $('#txt_h_amount').val(response.fee_tier.h_amount);
                    if (response.fee_tier.i == 'NON') {
                        response.fee_tier.i = '';
                    }
                    $('#ddl_i').val(response.fee_tier.i).trigger('change');
                    $('#ddl_i_from').val(response.fee_tier.i_from);
                    $('#txt_i_amount').val(response.fee_tier.i_amount);
                    if (response.fee_tier.j == 'NON') {
                        response.fee_tier.j = '';
                    }
                    $('#ddl_j').val(response.fee_tier.j).trigger('change');
                    $('#ddl_j_from').val(response.fee_tier.j_from);
                    $('#txt_j_amount').val(response.fee_tier.j_amount);
                    if (response.fee_tier.k == 'NON') {
                        response.fee_tier.k = '';
                    }
                    $('#ddl_k').val(response.fee_tier.k).trigger('change');
                    $('#ddl_k_from').val(response.fee_tier.k_from);
                    $('#txt_k_amount').val(response.fee_tier.k_amount);
                    if (response.fee_tier.l == 'NON') {
                        response.fee_tier.l = '';
                    }
                    $('#ddl_l').val(response.fee_tier.l).trigger('change');
                    $('#ddl_l_from').val(response.fee_tier.l_from);
                    $('#txt_l_amount').val(response.fee_tier.l_amount);
                    if (response.fee_tier.m == 'NON') {
                        response.fee_tier.m = '';
                    }
                    $('#ddl_m').val(response.fee_tier.m).trigger('change');
                    $('#ddl_m_from').val(response.fee_tier.m_from);
                    $('#txt_m_amount').val(response.fee_tier.m_amount);
                    if (response.fee_tier.n == 'NON') {
                        response.fee_tier.n = '';
                    }
                    $('#ddl_n').val(response.fee_tier.n).trigger('change');
                    $('#ddl_n_from').val(response.fee_tier.n_from);
                    $('#txt_n_amount').val(response.fee_tier.n_amount);
                    if (response.fee_tier.o == 'NON') {
                        response.fee_tier.o = '';
                    }
                    $('#ddl_o').val(response.fee_tier.o).trigger('change');
                    $('#ddl_o_from').val(response.fee_tier.o_from);
                    $('#txt_o_amount').val(response.fee_tier.o_amount);
                }

            },
            error: function (err) {
                console.log(err);
                location.reload();
            }
        });
    } else {
        $('#txt_service_name').val('{{ service_name }}');
        $('#txt_command').val('{{ command_name }}');
        $('#ddl_condition').val($("#ddl_condition option:first").val()).trigger('change');
        $('#txt_amount').val('');
        $('#ddl_fee_type').val($("#ddl_fee_type option:first").val()).trigger('change');
        $('#txt_fee_amount').val('');
        $('#ddl_bonus_type').val($("#ddl_bonus_type option:first").val()).trigger('change');
        $('#ddl_from').val($("#ddl_from option:first").val());
        $('#txt_bonus_amount').val('');
        $('#ddl_a').val($("#ddl_a option:first").val()).trigger('change');
        $('#ddl_a_from').val($("#ddl_a_from option:first").val());
        $('#txt_a_amount').val('');
        $('#ddl_b').val($("#ddl_b option:first").val()).trigger('change');
        $('#ddl_b_from').val($("#ddl_b_from option:first").val());
        $('#txt_b_amount').val('');
        $('#ddl_c').val($("#ddl_c option:first").val()).trigger('change');
        $('#ddl_c_from').val($("#ddl_c_from option:first").val());
        $('#txt_c_amount').val('');
        $('#ddl_d').val($("#ddl_d option:first").val()).trigger('change');
        $('#ddl_d_from').val($("#ddl_d_from option:first").val());
        $('#txt_d_amount').val('');
        $('#ddl_e').val($("#ddl_e option:first").val()).trigger('change');
        $('#ddl_e_from').val($("#ddl_e_from option:first").val());
        $('#txt_e_amount').val('');
        $('#ddl_f').val($("#ddl_f option:first").val()).trigger('change');
        $('#ddl_f_from').val($("#ddl_f_from option:first").val());
        $('#txt_f_amount').val('');
        $('#ddl_g').val($("#ddl_g option:first").val()).trigger('change');
        $('#ddl_g_from').val($("#ddl_g_from option:first").val());
        $('#txt_g_amount').val('');
        $('#ddl_h').val($("#ddl_h option:first").val()).trigger('change');
        $('#ddl_h_from').val($("#ddl_h_from option:first").val());
        $('#txt_h_amount').val('');
        $('#ddl_i').val($("#ddl_i option:first").val()).trigger('change');
        $('#ddl_i_from').val($("#ddl_i_from option:first").val());
        $('#txt_i_amount').val('');
        $('#ddl_j').val($("#ddl_j option:first").val()).trigger('change');
        $('#ddl_j_from').val($("#ddl_j_from option:first").val());
        $('#txt_j_amount').val('');
        $('#ddl_k').val($("#ddl_k option:first").val()).trigger('change');
        $('#ddl_k_from').val($("#ddl_k_from option:first").val());
        $('#txt_k_amount').val('');
        $('#ddl_l').val($("#ddl_l option:first").val()).trigger('change');
        $('#ddl_l_from').val($("#ddl_l_from option:first").val());
        $('#txt_l_amount').val('');
        $('#ddl_m').val($("#ddl_m option:first").val()).trigger('change');
        $('#ddl_m_from').val($("#ddl_m_from option:first").val());
        $('#txt_m_amount').val('');
        $('#ddl_n').val($("#ddl_n option:first").val()).trigger('change');
        $('#ddl_n_from').val($("#ddl_n_from option:first").val());
        $('#txt_n_amount').val('');
        $('#ddl_o').val($("#ddl_o option:first").val()).trigger('change');
        $('#ddl_o_from').val($("#ddl_o_from option:first").val());
        $('#txt_o_amount').val('');
    }
}

</script>
{%  endblock %}