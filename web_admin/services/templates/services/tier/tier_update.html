{% extends "base.html" %}

{% block content %}
<div class="panel mb25">
    <div class="panel-heading border">
        <h3>Edit Service Tier</h3>
    </div>
    {% for message in messages %}
   <div class="col-xs-12">
        <div class='alert
                    {%if "successfully" in message%}
                    alert-success
                    {% else %}
                    alert-danger
                    {% endif %}
                    alert-dismissable' id="msg-edit-tier">
            <a href="#" class="close" data-dismiss="alert" aria-label="close">Ã—</a>
            <strong>{{ message|capfirst }}</strong>
        </div>
    </div>
    {% endfor %}

    <div class="panel-body">
        <div class="row no-margin">
            <div class="col-lg-12">
                <form class="form-horizontal" role="form" method="post"
                      action="" onsubmit="return validateAmountFields()" id="form-data">
                    {% csrf_token %}
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Service Name</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="service_name" id="txt_service_name"
                                   value="{{ service_name }}" required readonly/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Command</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="command" id="txt_command"
                                   value="{{ command_name }}" required readonly/>
                        </div>
                    </div>

                    <div class="form-group" hidden>
                        <label class="col-sm-2 control-label" id="txt_settlement_type">Settlement Type</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_settlement_type" name="settlement_type">
                                {% for type in amount_types %}
                                    {% if type.amount_type == update_tier.settlement_type %}
                                        <option value="{{ type.amount_type }}" selected>{{ type.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ type.amount_type }}">{{ type.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Condition</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_condition" name="condition" required>
                                {% for item in conditions %}
                                    {% if item.fee_tier_condition == update_tier.fee_tier_condition %}
                                        <option value="{{ item.fee_tier_condition }}" selected="selected">{{item.fee_tier_condition}}</option>
                                    {% else %}
                                        <option value="{{ item.fee_tier_condition }}">{{item.fee_tier_condition}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_amount">Amount *</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.condition_amount }}" type="text" step="0.01" class="form-control"
                                   onchange="onChangesAmount('txt_amount');" name="condition_amount" id="txt_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label">Fee Type</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_fee_type" name="fee_type">
                                <option value="" selected="selected">-</option>
                                {% for item in fee_types %}
                                    {% if item.fee_type|stringformat:"s" == update_tier.fee_type|stringformat:"s" %}
                                        <option value="{{ item.fee_type }}" selected="selected">{{ item.fee_type }}</option>
                                    {% else %}
                                        <option value="{{ item.fee_type }}">{{ item.fee_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_fee_amount">Fee Amount *</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.fee_amount|default_if_none:'' }}" type="text"
                                   class="form-control" name="fee_amount" id="txt_fee_amount"
                                   onchange="onChangesAmount('txt_fee_amount');"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">Bonus Type</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_bonus_type" name="bonus_type" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.bonus_type %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="from" >
                        <label class="col-sm-2 control-label" id="txt_from">From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_from" name="amount_type">
                                {% for type in amount_types %}
                                    {% if type.amount_type == update_tier.amount_type %}
                                        <option value="{{ type.amount_type }}" selected="selected">{{ type.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ type.amount_type }}">{{ type.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_bonus_amount">Bonus Amount *</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.bonus_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_bonus_amount');" name="bonus_amount" id="txt_bonus_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ a_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_a" name="a" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.a %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="a_from" >
                        <label class="col-sm-2 control-label" id="txt_a_from">{{ a_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_a_from" name="a_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.a_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_a_amount">{{ a_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.a_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_a_amount');" name="a_amount" id="txt_a_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ b_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_b" name="b" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.b %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="b_from" >
                        <label class="col-sm-2 control-label" id="txt_b_from">{{ b_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_b_from" name="b_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.b_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_b_amount">{{ b_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.b_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_b_amount');" name="b_amount" id="txt_b_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ c_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_c" name="c" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.c %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="c_from" >
                        <label class="col-sm-2 control-label" id="txt_c_from">{{ c_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_c_from" name="c_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.c_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_c_amount">{{ c_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.c_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_c_amount');" name="c_amount" id="txt_c_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ d_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_d" name="d" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.d %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="d_from" >
                        <label class="col-sm-2 control-label" id="txt_d_from">{{ d_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_d_from" name="d_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.d_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_d_amount">{{ d_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.d_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_d_amount');" name="d_amount" id="txt_d_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ e_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_e" name="e" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.e %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="e_from" >
                        <label class="col-sm-2 control-label" id="txt_e_from">{{ e_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_e_from" name="e_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.e_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_e_amount">{{ e_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.e_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_e_amount');" name="e_amount" id="txt_e_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ f_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_f" name="f" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.f %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="f_from" >
                        <label class="col-sm-2 control-label" id="txt_f_from">{{ f_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_f_from" name="f_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.f_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_f_amount">{{ f_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.f_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_f_amount');" name="f_amount" id="txt_f_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ g_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_g" name="g" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.g %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="g_from" >
                        <label class="col-sm-2 control-label" id="txt_g_from">{{ g_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_g_from" name="g_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.g_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_g_amount">{{ g_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.g_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_g_amount');" name="g_amount" id="txt_g_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ h_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_h" name="h" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.h %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="h_from" >
                        <label class="col-sm-2 control-label" id="txt_h_from">{{ h_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_h_from" name="h_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.h_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_h_amount">{{ h_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.h_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_h_amount');" name="h_amount" id="txt_h_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ i_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_i" name="i" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.i %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="i_from" >
                        <label class="col-sm-2 control-label" id="txt_i_from">{{ i_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_i_from" name="i_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.i_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_i_amount">{{ i_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.i_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_i_amount');" name="i_amount" id="txt_i_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ j_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_j" name="j" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.j %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="j_from" >
                        <label class="col-sm-2 control-label" id="txt_j_from">{{ j_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_j_from" name="j_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.j_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_j_amount">{{ j_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.j_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_j_amount');" name="j_amount" id="txt_j_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ k_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_k" name="k" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.k %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="k_from" >
                        <label class="col-sm-2 control-label" id="txt_k_from">{{ k_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_k_from" name="k_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.k_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_k_amount">{{ k_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.k_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_k_amount');" name="k_amount" id="txt_k_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ l_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_l" name="l" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.l %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="l_from" >
                        <label class="col-sm-2 control-label" id="txt_l_from">{{ l_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_l_from" name="l_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.l_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_l_amount">{{ l_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.l_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_l_amount');" name="l_amount" id="txt_l_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ m_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_m" name="m" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.m %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="m_from" >
                        <label class="col-sm-2 control-label" id="txt_m_from">{{ m_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_m_from" name="m_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.m_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_m_amount">{{ m_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.m_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_m_amount');" name="m_amount" id="txt_m_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ n_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_n" name="n" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.n %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="n_from" >
                        <label class="col-sm-2 control-label" id="txt_n_from">{{ n_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_n_from" name="n_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.n_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_n_amount">{{ n_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.n_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_n_amount');" name="n_amount" id="txt_n_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">{{ o_label }}</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_o" name="o" >
                                <option value="">-</option>
                                {% for item in bonus_types %}
                                    {% if item.bonus_type == update_tier.o %}
                                        <option value="{{ item.bonus_type }}" selected="selected" >{{ item.bonus_type }}</option>
                                    {% else %}
                                        <option value="{{ item.bonus_type }}">{{ item.bonus_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="o_from" >
                        <label class="col-sm-2 control-label" id="txt_o_from">{{ o_label }} From</label>
                        <div class="col-sm-2">
                            <select class="form-control" id="ddl_o_from" name="o_from">
                                {% for item in tier_amount_froms %}
                                    {% if item.amount_type == update_tier.o_from %}
                                        <option value="{{ item.amount_type }}" selected="selected" >{{ item.amount_type }}</option>
                                    {% else %}
                                        <option value="{{ item.amount_type }}">{{ item.amount_type }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" id="label_o_amount">{{ o_label }} Amount</label>
                        <div class="col-sm-8">
                            <input value="{{ update_tier.o_amount|default_if_none:'' }}" type="text" class="form-control"
                                   onchange="onChangesAmount('txt_o_amount');" name="o_amount" id="txt_o_amount"
                                   onkeypress="if (event.key.replace(/[^\w\.\,]/g,'')=='') event.preventDefault();" required/>
                        </div>
                    </div>

                <div class="panel-body">
                    <div class="pull-right">
                        <a href="{% url 'services:fee_tier_list' service_id command_id service_command_id %}">
                            <input id="btn_cancel" class="btn text-left mb15" type="button"
                                   value="Cancel"/>
                        </a>

                        <input id="btn_save" class="btn btn-success text-left mb15" type="submit"
                                   value="Save"/>

                    </div>
                </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}
{% block body_js %}
{{ block.super }}
<script>
function forceAmountNumber(any_amount) {
    var deci = {{ decimal }};
    var amount = document.getElementById(any_amount);
    any_amt = $('#'+any_amount);
    any_amt.keypress(function(event) {
        var $this = $(this);
        if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
        ((event.which < 48 || event.which > 57) &&
        (event.which != 0 && event.which != 8))) {
            event.preventDefault();
            }

        var text = $(this).val();
        if ((event.which == 46) && (text.indexOf('.') == -1)) {
            setTimeout(function() {
                if ($this.val().substring($this.val().indexOf('.')).length > deci + 1) {
                    $this.val($this.val().substring(0, $this.val().indexOf('.') + deci + 1));
                    }
                }, 1);
            }
        if ((text.indexOf('.') != -1) &&
        (text.substring(text.indexOf('.')).length > deci) &&
        (event.which != 0 && event.which != 8) &&
        ($(this)[0].selectionStart >= text.length - deci)) {
            event.preventDefault();
            }
        });

        any_amt.bind("paste", function(e) {
            var text = e.originalEvent.clipboardData.getData('Text');
            if ($.isNumeric(text)) {
                if ((text.substring(text.indexOf('.')).length > deci +1 ) && (text.indexOf('.') > -1)) {
                    e.preventDefault();
                    $(this).val(text.substring(0, text.indexOf('.') + deci + 1));
                    }
                }
            else {
                e.preventDefault();
                }
        });

    amount.onblur = function(){

        num = amount.value;
            if (num != "") {
                num = parseFloat(num);
                num = num.toFixed(deci);
                amount.value = num;
            }
        }
    }

function forceNumber(any_amount, any_type) {
    var deci = 0;
    var ddl = document.getElementById(any_type);
    if (ddl.value == '% rate'){ deci = {{ payment_decimal }}; }
    else if (ddl.value == 'Flat value'){ deci = {{ decimal }}; }
    else { deci = 0; }
    var amount = document.getElementById(any_amount);
    ddl.onchange = function() {
        console.log("1"+amount);
        amount.value = '';
    }
    console.log("2"+amount);
    any_amt = $('#'+any_amount);
    var e = document.getElementById(any_type);
        if (e.value == '% rate'){
            deci = {{ payment_decimal }};
            }
        else if ( e.value == 'Flat value'){
            deci = {{ decimal }};
            }
        else {deci = 0;}

    $('#' + any_type).change(function() {
        var e = document.getElementById(any_type);
        if (e.value == '% rate'){
            deci = {{ payment_decimal }};
            }
        else if ( e.value == 'Flat value'){
            deci = {{ decimal }};
            }
        else {deci = 0;}
        });

    any_amt.keypress(function(event) {
        var $this = $(this);
        if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
        ((event.which < 48 || event.which > 57) &&
        (event.which != 0 && event.which != 8))) {
            event.preventDefault();
            }

        var text = $(this).val();
        if ((event.which == 46) && (text.indexOf('.') == -1)) {
            setTimeout(function() {
                if ($this.val().substring($this.val().indexOf('.')).length > deci + 1) {
                    $this.val($this.val().substring(0, $this.val().indexOf('.') + deci + 1));
                    }
                }, 1);
            }
        if ((text.indexOf('.') != -1) &&
        (text.substring(text.indexOf('.')).length > deci) &&
        (event.which != 0 && event.which != 8) &&
        ($(this)[0].selectionStart >= text.length - deci)) {
            event.preventDefault();
            }
        });

    any_amt.bind("paste", function(e) {
        var text = e.originalEvent.clipboardData.getData('Text');
        if ($.isNumeric(text)) {
            if ((text.substring(text.indexOf('.')).length > deci +1 ) && (text.indexOf('.') > -1)) {
                    e.preventDefault();
                    $(this).val(text.substring(0, text.indexOf('.') + deci + 1));
                    }
                }
            else {
                e.preventDefault();
                }
        });

    amount.onblur = function(){
        num = amount.value;
            if (num != "") {
                num = parseFloat(num);
                num = num.toFixed(deci);
                amount.value = num;
            }
        }
    }

forceAmountNumber("txt_amount");
forceNumber("txt_fee_amount", "ddl_fee_type");
forceNumber("txt_bonus_amount","ddl_bonus_type");
forceNumber("txt_a_amount","ddl_a");
forceNumber("txt_b_amount","ddl_b");
forceNumber("txt_c_amount","ddl_c");
forceNumber("txt_d_amount","ddl_d");
forceNumber("txt_e_amount","ddl_e");
forceNumber("txt_f_amount","ddl_f");
forceNumber("txt_g_amount","ddl_g");
forceNumber("txt_h_amount","ddl_h");
forceNumber("txt_i_amount","ddl_i");
forceNumber("txt_j_amount","ddl_j");
forceNumber("txt_k_amount","ddl_k");
forceNumber("txt_l_amount","ddl_l");
forceNumber("txt_m_amount","ddl_m");
forceNumber("txt_n_amount","ddl_n");
forceNumber("txt_o_amount","ddl_o");

// start tier level constraint
var  $a = $('#ddl_a');
if( $a.val() == ''){
    $('#txt_a_amount').attr('disabled', true);
    $("#a_from").hide();
}
if( $a.val() == 'Flat value') {
    $("#a_from").hide();
}
     $a.change(function(){
        if( $a.val() == ''){
            $('#txt_a_amount').attr('disabled', true);

            $('#txt_a_amount').val('');
            $("#a_from").fadeOut(500);
        }
        else if( $a.val() == 'Flat value'){
            $('#txt_a_amount').removeAttr('disabled');
            if($('#txt_a_amount').val() == '') {
                $('#txt_a_amount').val('0');
            }
            $("#a_from").fadeOut(500);
        }
        else if( $a.val() == '% rate'){
            $('#txt_a_amount').removeAttr('disabled');
            if($('#txt_a_amount').val() == '') {
                $('#txt_a_amount').val('0');
            }
            $("#a_from").fadeIn(1000);
        }
    })

var  $b = $('#ddl_b');
if( $b.val() == ''){
    $('#txt_b_amount').attr('disabled', true);
    $("#b_from").hide();
}
if( $b.val() == 'Flat value') {
    $("#b_from").hide();
}
     $b.change(function(){
        if( $b.val() == ''){
            $('#txt_b_amount').attr('disabled', true);

            $('#txt_b_amount').val('');
            $("#b_from").fadeOut(500);
        }
        else if( $b.val() == 'Flat value'){
            $('#txt_b_amount').removeAttr('disabled');
            if($('#txt_b_amount').val() == '') {
                $('#txt_b_amount').val('0');
            }
            $("#b_from").fadeOut(500);
        }
        else if( $b.val() == '% rate'){
            $('#txt_b_amount').removeAttr('disabled');
            if($('#txt_b_amount').val() == '') {
                $('#txt_b_amount').val('0');
            }
            $("#b_from").fadeIn(1000);
        }
    })


var  $c = $('#ddl_c');
if( $c.val() == ''){
    $('#txt_c_amount').attr('disabled', true);
    $("#c_from").hide();
}
if( $c.val() == 'Flat value') {
    $("#c_from").hide();
}
     $c.change(function(){
        if( $c.val() == ''){
            $('#txt_c_amount').attr('disabled', true);

            $('#txt_c_amount').val('');
            $("#c_from").fadeOut(500);
        }
        else if( $c.val() == 'Flat value'){
            $('#txt_c_amount').removeAttr('disabled');
            if($('#txt_c_amount').val() == '') {
                $('#txt_c_amount').val('0');
            }
            $("#c_from").fadeOut(500);
        }
        else if( $c.val() == '% rate'){
            $('#txt_c_amount').removeAttr('disabled');
            if($('#txt_c_amount').val() == '') {
                $('#txt_c_amount').val('0');
            }
            $("#c_from").fadeIn(1000);
        }
    })


var  $d = $('#ddl_d');
if( $d.val() == ''){
    $('#txt_d_amount').attr('disabled', true);
    $("#d_from").hide();
}
if( $d.val() == 'Flat value') {
    $("#d_from").hide();
}
     $d.change(function(){
        if( $d.val() == ''){
            $('#txt_d_amount').attr('disabled', true);

            $('#txt_d_amount').val('');
            $("#d_from").fadeOut(500);
        }
        else if( $d.val() == 'Flat value'){
            $('#txt_d_amount').removeAttr('disabled');
            if($('#txt_d_amount').val() == '') {
                $('#txt_d_amount').val('0');
            }
            $("#d_from").fadeOut(500);
        }
        else if( $d.val() == '% rate'){
            $('#txt_d_amount').removeAttr('disabled');
            if($('#txt_d_amount').val() == '') {
                $('#txt_d_amount').val('0');
            }
            $("#d_from").fadeIn(1000);
        }
    })


var  $e = $('#ddl_e');
if( $e.val() == ''){
    $('#txt_e_amount').attr('disabled', true);
    $("#e_from").hide();
}
if( $e.val() == 'Flat value') {
    $("#e_from").hide();
}
     $e.change(function(){
        if( $e.val() == ''){
            $('#txt_e_amount').attr('disabled', true);

            $('#txt_e_amount').val('');
            $("#e_from").fadeOut(500);
        }
        else if( $e.val() == 'Flat value'){
            $('#txt_e_amount').removeAttr('disabled');
            if($('#txt_e_amount').val() == '') {
                $('#txt_e_amount').val('0');
            }
            $("#e_from").fadeOut(500);
        }
        else if( $e.val() == '% rate'){
            $('#txt_e_amount').removeAttr('disabled');
            if($('#txt_e_amount').val() == '') {
                $('#txt_e_amount').val('0');
            }
            $("#e_from").fadeIn(1000);
        }
    })


var  $f = $('#ddl_f');
if( $f.val() == ''){
    $('#txt_f_amount').attr('disabled', true);
    $("#f_from").hide();
}
if( $f.val() == 'Flat value') {
    $("#f_from").hide();
}
     $f.change(function(){
        if( $f.val() == ''){
            $('#txt_f_amount').attr('disabled', true);

            $('#txt_f_amount').val('');
            $("#f_from").fadeOut(500);
        }
        else if( $f.val() == 'Flat value'){
            $('#txt_f_amount').removeAttr('disabled');
            if($('#txt_f_amount').val() == '') {
                $('#txt_f_amount').val('0');
            }
            $("#f_from").fadeOut(500);
        }
        else if( $f.val() == '% rate'){
            $('#txt_f_amount').removeAttr('disabled');
            if($('#txt_f_amount').val() == '') {
                $('#txt_f_amount').val('0');
            }
            $("#f_from").fadeIn(1000);
        }
    })


var  $g = $('#ddl_g');
if( $g.val() == ''){
    $('#txt_g_amount').attr('disabled', true);
    $("#g_from").hide();
}
if( $g.val() == 'Flat value') {
    $("#g_from").hide();
}
     $g.change(function(){
        if( $g.val() == ''){
            $('#txt_g_amount').attr('disabled', true);

            $('#txt_g_amount').val('');
            $("#g_from").fadeOut(500);
        }
        else if( $g.val() == 'Flat value'){
            $('#txt_g_amount').removeAttr('disabled');
            if($('#txt_g_amount').val() == '') {
                $('#txt_g_amount').val('0');
            }
            $("#g_from").fadeOut(500);
        }
        else if( $g.val() == '% rate'){
            $('#txt_g_amount').removeAttr('disabled');
            if($('#txt_g_amount').val() == '') {
                $('#txt_g_amount').val('0');
            }
            $("#g_from").fadeIn(1000);
        }
    })


var  $h = $('#ddl_h');
if( $h.val() == ''){
    $('#txt_h_amount').attr('disabled', true);
    $("#h_from").hide();
}
if( $h.val() == 'Flat value') {
    $("#h_from").hide();
}
     $h.change(function(){
        if( $h.val() == ''){
            $('#txt_h_amount').attr('disabled', true);

            $('#txt_h_amount').val('');
            $("#h_from").fadeOut(500);
        }
        else if( $h.val() == 'Flat value'){
            $('#txt_h_amount').removeAttr('disabled');
            if($('#txt_h_amount').val() == '') {
                $('#txt_h_amount').val('0');
            }
            $("#h_from").fadeOut(500);
        }
        else if( $h.val() == '% rate'){
            $('#txt_h_amount').removeAttr('disabled');
            if($('#txt_h_amount').val() == '') {
                $('#txt_h_amount').val('0');
            }
            $("#h_from").fadeIn(1000);
        }
    })


var  $i = $('#ddl_i');
if( $i.val() == ''){
    $('#txt_i_amount').attr('disabled', true);
    $("#i_from").hide();
}
if( $i.val() == 'Flat value') {
    $("#i_from").hide();
}
     $i.change(function(){
        if( $i.val() == ''){
            $('#txt_i_amount').attr('disabled', true);

            $('#txt_i_amount').val('');
            $("#i_from").fadeOut(500);
        }
        else if( $i.val() == 'Flat value'){
            $('#txt_i_amount').removeAttr('disabled');
            if($('#txt_i_amount').val() == '') {
                $('#txt_i_amount').val('0');
            }
            $("#i_from").fadeOut(500);
        }
        else if( $i.val() == '% rate'){
            $('#txt_i_amount').removeAttr('disabled');
            if($('#txt_i_amount').val() == '') {
                $('#txt_i_amount').val('0');
            }
            $("#i_from").fadeIn(1000);
        }
    })


var  $j = $('#ddl_j');
if( $j.val() == ''){
    $('#txt_j_amount').attr('disabled', true);
    $("#j_from").hide();
}
if( $j.val() == 'Flat value') {
    $("#j_from").hide();
}
     $j.change(function(){
        if( $j.val() == ''){
            $('#txt_j_amount').attr('disabled', true);

            $('#txt_j_amount').val('');
            $("#j_from").fadeOut(500);
        }
        else if( $j.val() == 'Flat value'){
            $('#txt_j_amount').removeAttr('disabled');
            if($('#txt_j_amount').val() == '') {
                $('#txt_j_amount').val('0');
            }
            $("#j_from").fadeOut(500);
        }
        else if( $j.val() == '% rate'){
            $('#txt_j_amount').removeAttr('disabled');
            if($('#txt_j_amount').val() == '') {
                $('#txt_j_amount').val('0');
            }
            $("#j_from").fadeIn(1000);
        }
    })


var  $k = $('#ddl_k');
if( $k.val() == ''){
    $('#txt_k_amount').attr('disabled', true);
    $("#k_from").hide();
}
if( $k.val() == 'Flat value') {
    $("#k_from").hide();
}
     $k.change(function(){
        if( $k.val() == ''){
            $('#txt_k_amount').attr('disabled', true);

            $('#txt_k_amount').val('');
            $("#k_from").fadeOut(500);
        }
        else if( $k.val() == 'Flat value'){
            $('#txt_k_amount').removeAttr('disabled');
            if($('#txt_k_amount').val() == '') {
                $('#txt_k_amount').val('0');
            }
            $("#k_from").fadeOut(500);
        }
        else if( $k.val() == '% rate'){
            $('#txt_k_amount').removeAttr('disabled');
            if($('#txt_k_amount').val() == '') {
                $('#txt_k_amount').val('0');
            }
            $("#k_from").fadeIn(1000);
        }
    })


var  $l = $('#ddl_l');
if( $l.val() == ''){
    $('#txt_l_amount').attr('disabled', true);
    $("#l_from").hide();
}
if( $l.val() == 'Flat value') {
    $("#l_from").hide();
}
     $l.change(function(){
        if( $l.val() == ''){
            $('#txt_l_amount').attr('disabled', true);

            $('#txt_l_amount').val('');
            $("#l_from").fadeOut(500);
        }
        else if( $l.val() == 'Flat value'){
            $('#txt_l_amount').removeAttr('disabled');
            if($('#txt_l_amount').val() == '') {
                $('#txt_l_amount').val('0');
            }
            $("#l_from").fadeOut(500);
        }
        else if( $l.val() == '% rate'){
            $('#txt_l_amount').removeAttr('disabled');
            if($('#txt_l_amount').val() == '') {
                $('#txt_l_amount').val('0');
            }
            $("#l_from").fadeIn(1000);
        }
    })


var  $m = $('#ddl_m');
if( $m.val() == ''){
    $('#txt_m_amount').attr('disabled', true);
    $("#m_from").hide();
}
if( $m.val() == 'Flat value') {
    $("#m_from").hide();
}
     $m.change(function(){
        if( $m.val() == ''){
            $('#txt_m_amount').attr('disabled', true);

            $('#txt_m_amount').val('');
            $("#m_from").fadeOut(500);
        }
        else if( $m.val() == 'Flat value'){
            $('#txt_m_amount').removeAttr('disabled');
            if($('#txt_m_amount').val() == '') {
                $('#txt_m_amount').val('0');
            }
            $("#m_from").fadeOut(500);
        }
        else if( $m.val() == '% rate'){
            $('#txt_m_amount').removeAttr('disabled');
            if($('#txt_m_amount').val() == '') {
                $('#txt_m_amount').val('0');
            }
            $("#m_from").fadeIn(1000);
        }
    })


var  $n = $('#ddl_n');
if( $n.val() == ''){
    $('#txt_n_amount').attr('disabled', true);
    $("#n_from").hide();
}
if( $n.val() == 'Flat value') {
    $("#n_from").hide();
}
     $n.change(function(){
        if( $n.val() == ''){
            $('#txt_n_amount').attr('disabled', true);

            $('#txt_n_amount').val('');
            $("#n_from").fadeOut(500);
        }
        else if( $n.val() == 'Flat value'){
            $('#txt_n_amount').removeAttr('disabled');
            if($('#txt_n_amount').val() == '') {
                $('#txt_n_amount').val('0');
            }
            $("#n_from").fadeOut(500);
        }
        else if( $n.val() == '% rate'){
            $('#txt_n_amount').removeAttr('disabled');
            if($('#txt_n_amount').val() == '') {
                $('#txt_n_amount').val('0');
            }
            $("#n_from").fadeIn(1000);
        }
    })


var  $o = $('#ddl_o');
if( $o.val() == ''){
    $('#txt_o_amount').attr('disabled', true);
    $("#o_from").hide();
}
if( $o.val() == 'Flat value') {
    $("#o_from").hide();
}
     $o.change(function(){
        if( $o.val() == ''){
            $('#txt_o_amount').attr('disabled', true);

            $('#txt_o_amount').val('');
            $("#o_from").fadeOut(500);
        }
        else if( $o.val() == 'Flat value'){
            $('#txt_o_amount').removeAttr('disabled');
            if($('#txt_o_amount').val() == '') {
                $('#txt_o_amount').val('0');
            }
            $("#o_from").fadeOut(500);
        }
        else if( $o.val() == '% rate'){
            $('#txt_o_amount').removeAttr('disabled');
            if($('#txt_o_amount').val() == '') {
                $('#txt_o_amount').val('0');
            }
            $("#o_from").fadeIn(1000);
        }
    })
// end tier level constraint


// start Amount constraint
var $condition = $('#ddl_condition');
    function updateByConditionType() {
        var $condition_amount = $('#txt_amount');
        if ($condition.val() == 'unlimit') {
            $("#label_amount").text("Amount");
            $condition_amount.removeAttr('required');
            $condition_amount.attr('disabled', true);
            $condition_amount.val('');
        } else {
            $("#label_amount").text("Amount *");
            $condition_amount.attr('required', true);
            $condition_amount.removeAttr('disabled');
        }
    }
    updateByConditionType();
    $condition.change(function() {
        updateByConditionType();
    });
// end amount constraint


// start Fee Amount constraint
var $ddl_fee_type = $('#ddl_fee_type');

    function validate_fee_type() {
        if ($ddl_fee_type.val() == '') {
            $('#txt_fee_amount').attr('disabled', true);
            $('#txt_fee_amount').val('');
            $("#label_fee_amount").text("Fee Amount");
        } else {
            $("#label_fee_amount").text("Fee Amount *")
            $('#txt_fee_amount').removeAttr('disabled');
            if($('#txt_fee_amount').val() == '') {
                $('#txt_fee_amount').val('0');
            }
        }
    }

    $ddl_fee_type.change(function() {
        validate_fee_type();
        var element = document.getElementById('txt_fee_amount');
        element.setCustomValidity("");
    });
    validate_fee_type();
// end Fee Amount constraint

// start Bonus Amount constraint
var $bonus_type = $('#ddl_bonus_type');
if($bonus_type.val() == ''){
    $('#txt_bonus_amount').attr('disabled', true);
    $("#label_bonus_amount").text("Bonus Amount");
    $("#from").hide();
}
if($bonus_type.val() == 'Flat value') {
    $("#from").hide();
}
    $bonus_type.change(function(){
        if($bonus_type.val() == ''){
            $('#txt_bonus_amount').attr('disabled', true);

            $('#txt_bonus_amount').val('');
            $("#label_bonus_amount").text("Bonus Amount");
            $("#from").fadeOut(500);
        }
        else if($bonus_type.val() == 'Flat value'){
            $('#txt_bonus_amount').removeAttr('disabled');
            if($('#txt_bonus_amount').val() == '') {
                $('#txt_bonus_amount').val('0');
            }
            $("#label_bonus_amount").text("Bonus Amount *");
            $("#from").fadeOut(500);
        }
        else if($bonus_type.val() == '% rate'){
            $('#txt_bonus_amount').removeAttr('disabled');
            if($('#txt_bonus_amount').val() == '') {
                $('#txt_bonus_amount').val('0');
            }
            $("#label_bonus_amount").text("Bonus Amount *");
            $("#from").fadeIn(1000);
        }
    })
// end Bonus Amount constraint

var txt_bonus_amount = document.getElementById("txt_bonus_amount");
var txt_fee_amount = document.getElementById('txt_fee_amount');
var condition_amount = document.getElementById('txt_amount');

function onChangesAmount(s) {
    var x = document.getElementById(s);
    if (x.value == '') {
        x.value = 0
    }
};

function validateBonusValue() {
    /*if(txt_bonus_amount.value == '') {
        <!--txt_bonus_amount.value = '0';-->
    } else {
        txt_bonus_amount.value = txt_bonus_amount.value.replace(/^0+/, '')
    }

    if(txt_bonus_amount.value == '') {
        <!--txt_bonus_amount.value = '0';-->
    }*/

    // Validate min value
    return validateMinValue(txt_bonus_amount);
}

function validateFeeValue() {
    /*if(txt_fee_amount.value == '') {
        <!--txt_fee_amount.value = '0';-->
    } else {
        txt_fee_amount.value = txt_fee_amount.value.replace(/^0+/, '')
    }

    if(txt_fee_amount.value == '') {
        <!--txt_fee_amount.value = '0';-->
    }*/

    // Validate min value
    if(validateMinValue(txt_fee_amount)) {
        var $ddl_fee_type = $('#ddl_fee_type');
        if ($ddl_fee_type.val() == '% rate') {
            return validateMaxValue(txt_fee_amount);
        }
        return true;
    } else {
        return false;
    }
}

function validateConditionAmount() {
    return validateMinValue(condition_amount);
}

function validateMinValue(element) {
    var value = parseFloat(element.value) || 0.0;
    if(value < 0) {
        element.setCustomValidity('Amount cannot be lower than 0');
        return false;
    } else {
        element.setCustomValidity("");
        //element.value = value;
        return true;
    }
}

function validateMaxValue(element) {
    var max = parseInt(element.getAttribute("max")) || 100;
    var value = parseFloat(element.value) || 0.0;
    var value = parseFloat(element.value) || 0.0;
    if(value > max) {
        element.setCustomValidity('Amount cannot be greater than ' + max);
        return false;
    } else {
        element.setCustomValidity("");
        //element.value = value;
        return true;
    }
}

function validateAmountFields() {
    return validateConditionAmount() && validateFeeValue() && validateBonusValue();
}

txt_bonus_amount.onkeyup = validateBonusValue;
txt_fee_amount.onkeyup = validateFeeValue;
condition_amount.onkeyup = validateConditionAmount;
</script>
{%  endblock %}